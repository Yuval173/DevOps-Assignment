# Design Decision: Rate limit set to 5r/s as per requirements.
limit_req_zone $binary_remote_addr zone=mylimit:10m rate=5r/s;

# Server 1: Custom HTML and HTTPS support
server {
    listen 8080 default_server;
    listen 443 ssl default_server;
    server_name _;

    ssl_certificate /etc/nginx/ssl/nginx.crt;
    ssl_certificate_key /etc/nginx/ssl/nginx.key;

    location / {
        # burst=5 allows small spikes for HTTPS tests to pass.
        limit_req zone=mylimit burst=5 nodelay; 
        root /usr/share/nginx/html;
        index index.html;
    }
}

# Server 2: Mandatory Error Response
server {
    listen 8081;
    server_name _;

    # Requirement: Return an HTTP error response.
    return 500 "Internal Server Error";
}